@layer components {
  

  
  @scope (.arsenal-header) {
    :scope {
      display: grid;
      grid-template-columns: 1fr auto;
      grid-template-rows: auto auto;
      gap: 0 var(--space-lg);
      margin-block-end: var(--space-md);
      align-items: center;

      & h2 {
        grid-column: 1;
        grid-row: 1;
        margin-block-end: 0;
      }

      & .step-desc {
        grid-column: 1;
        grid-row: 2;
        margin-block-end: 0;
        padding-inline-start: calc(2rem + var(--space-md));
      }
    }

    .actions {
      grid-column: 2;
      grid-row: 1 / 3;
      display: flex;
      align-items: flex-start;
      justify-content: flex-end;
      gap: var(--space-sm);
      margin-block-start: 2px;
    }
  }

  
  @scope (.software-toolbar) {
    :scope {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      margin-block-end: var(--space-md);
    }

    .search-wrap {
      flex: 1;
      position: relative;

      &::before {
        content: "";
        position: absolute;
        inset: -2px;
        background: linear-gradient(
          90deg,
          oklch(0.6 0.2 30) 0%,
          oklch(0.7 0.15 50) 25%,
          oklch(0.6 0.2 30) 50%,
          oklch(0.5 0.2 20) 75%,
          oklch(0.6 0.2 30) 100%
        );
        background-size: 200% 100%;
        clip-path: var(--clip-cyber-sm);
        opacity: 0;
        transition: opacity var(--duration-slow) ease;
        z-index: -1;
        animation: searchGlow 3s linear infinite;
      }

      &:focus-within::before {
        opacity: 1;
      }
    }

    .search-icon {
      position: absolute;
      inset-inline-start: 14px;
      inset-block-start: 50%;
      transform: translateY(-50%);
      inline-size: var(--icon-md);
      block-size: var(--icon-md);
      color: oklch(0.6 0.15 40);
      pointer-events: none;
      transition: all var(--duration-normal) ease;
      z-index: 1;

      .search-wrap:focus-within & {
        color: oklch(0.75 0.2 35);
        filter: drop-shadow(0 0 4px oklch(0.7 0.2 35 / 0.6));
      }
    }

    .search-input {
      inline-size: 100%;
      padding: 12px 16px 12px 44px;
      background: linear-gradient(
        135deg,
        color-mix(in oklch, oklch(0.15 0.02 40) 80%, transparent) 0%,
        color-mix(in oklch, oklch(0.1 0.01 30) 90%, transparent) 100%
      );
      border: 1px solid oklch(0.35 0.08 40);
      color: var(--text-primary);
      font-size: var(--text-base);
      font-family: var(--font-ui);
      font-weight: 500;
      letter-spacing: 0.02em;
      transition: all var(--duration-normal) ease;
      clip-path: var(--clip-cyber-sm);

      &::placeholder {
        color: oklch(0.5 0.05 40);
        font-style: italic;
        letter-spacing: var(--tracking-normal);
      }

      &:focus {
        outline: none;
        background: linear-gradient(
          135deg,
          color-mix(in oklch, oklch(0.18 0.04 35) 90%, transparent) 0%,
          color-mix(in oklch, oklch(0.12 0.03 30) 95%, transparent) 100%
        );
        border-color: oklch(0.55 0.15 35);
        box-shadow:
          inset 0 0 20px oklch(0.5 0.1 35 / 0.2),
          0 0 20px oklch(0.5 0.15 35 / 0.3);
      }
    }
  }

  
  @scope (.filter-bar) {
    :scope {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2xs);
      margin-block-end: var(--space-md);
    }

    .filter {
      font-family: var(--font-ui);
      padding: var(--space-2xs) var(--space-sm);
      background: var(--white-5);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      font-size: var(--text-sm);
      font-weight: 600;
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-out-expo);
      display: inline-flex;
      align-items: center;
      gap: var(--space-2xs);
      clip-path: var(--clip-cyber-sm);
      position: relative;

      
      opacity: 0;
      transform: translateY(8px);
      animation: filterEnter 0.4s var(--ease-out-expo) forwards;

      &::before {
        content: "";
        position: absolute;
        inset: 0;
        clip-path: var(--clip-cyber-sm);
        background: linear-gradient(
          135deg,
          transparent 40%,
          var(--white-10) 100%
        );
        pointer-events: none;
      }

      &:hover {
        background: var(--white-10);
        border-color: var(--border-light);
        color: var(--text-primary);
        transform: translateY(-1px);
      }

      &.active {
        background: linear-gradient(135deg, var(--accent), var(--accent-dim));
        border-color: var(--accent);
        color: white;
        text-shadow:
          0 0 6px var(--white-40),
          0 0 12px var(--accent-glow-strong);
        box-shadow:
          0 0 12px var(--accent-glow),
          var(--shadow-md);

        &::after {
          content: "";
          position: absolute;
          inset: -2px;
          background: linear-gradient(135deg, var(--accent), var(--neon-cyan));
          clip-path: polygon(
            9px 0, 100% 0, 100% calc(100% - 9px),
            calc(100% - 9px) 100%, 0 100%, 0 9px
          );
          z-index: -1;
          opacity: 0.4;
          filter: blur(4px);
          animation: activeFilterGlow var(--anim-normal) ease-in-out infinite;
        }
      }

      &.filter--selected {
        border-color: var(--accent);
        color: var(--accent);

        &:hover {
          background: var(--accent-10);
        }

        &.active {
          background: linear-gradient(135deg, var(--accent), var(--accent-dim));
          color: white;
        }
      }
    }

    
    .filter-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-inline-size: 18px;
      block-size: 18px;
      padding: 0 5px;
      font-size: var(--text-xs);
      font-weight: 700;
      font-family: var(--font-mono);
      background: var(--accent-20);
      border-radius: 3px;
      color: var(--accent);
    }

    
    .filter--recommended {
      position: relative;
      border-color: color-mix(in oklch, var(--accent) 50%, var(--border));
      color: var(--accent);
      font-weight: 600;

      .filter-badge {
        background: var(--accent-25);
      }

      &:hover {
        background: var(--accent-15);
        border-color: var(--accent);
        color: var(--text-primary);
      }

      &.active {
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dim) 100%);
        border-color: var(--accent);
        color: white;

        .filter-badge {
          background: var(--white-20);
          color: white;
        }
      }
    }
  }

  
  @scope (.selected-action-badge) {
    :scope {
      display: flex;
      align-items: stretch;
      clip-path: var(--clip-cyber-sm);
      background: linear-gradient(
        135deg,
        color-mix(in oklch, var(--accent) 15%, var(--bg-tertiary)) 0%,
        var(--bg-tertiary) 100%
      );
      border: 1px solid color-mix(in oklch, var(--accent) 40%, var(--border));
      position: relative;
      overflow: hidden;
      transition: all var(--duration-normal) var(--ease-out-expo);
      opacity: 0.5;

      &::before {
        content: "";
        position: absolute;
        inset-block: 0;
        inset-inline-start: 0;
        inline-size: 3px;
        background: linear-gradient(180deg, var(--accent), var(--neon-cyan));
        opacity: 0.5;
        transition: opacity var(--duration-normal);
      }

      &.has-selection {
        opacity: 1;

        &::before {
          opacity: 1;
        }
      }

      &.has-selection:hover {
        border-color: var(--accent);
        box-shadow:
          0 0 20px var(--accent-20),
          inset 0 0 30px var(--accent-5);
      }
    }

    .selected-count-btn {
      display: flex;
      align-items: center;
      gap: var(--space-2xs);
      padding: var(--space-xs) var(--space-sm) var(--space-xs) var(--space-md);
      font-family: var(--font-ui);
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--accent);
      letter-spacing: 0.02em;
      white-space: nowrap;
      background: transparent;
      border: none;
      cursor: pointer;
      transition: all var(--duration-fast) ease;

      .check-icon {
        inline-size: 14px;
        block-size: 14px;
        color: var(--neon-cyan);
        filter: drop-shadow(0 0 4px var(--neon-cyan-glow));
        transition: transform var(--duration-fast) ease;
      }

      #software-counter {
        font-family: var(--font-mono);
        font-weight: 700;
        font-size: var(--text-base);
        color: var(--text-primary);
        text-shadow: var(--glow-sm) var(--accent-glow);
      }

      &:hover {
        color: var(--text-primary);

        .check-icon {
          transform: scale(1.1);
          filter: drop-shadow(0 0 6px var(--neon-cyan));
        }
      }

      &.active {
        background: linear-gradient(
          135deg,
          var(--accent-20) 0%,
          color-mix(in oklch, var(--neon-cyan) 10%, transparent) 100%
        );
        color: var(--text-primary);
      }
    }

    .purge-btn {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: var(--space-xs) 14px;
      font-family: var(--font-display);
      font-size: var(--text-xs);
      font-weight: 700;
      letter-spacing: var(--tracking-normal);
      text-transform: uppercase;
      white-space: nowrap;
      background: linear-gradient(
        135deg,
        color-mix(in oklch, oklch(0.45 0.22 15) 30%, transparent) 0%,
        color-mix(in oklch, oklch(0.35 0.25 10) 20%, transparent) 100%
      );
      border: none;
      border-inline-start: 1px solid color-mix(in oklch, oklch(0.5 0.2 20) 50%, transparent);
      color: oklch(0.7 0.18 20);
      cursor: pointer;
      transition: all var(--duration-fast) var(--ease-out-expo);
      position: relative;
      overflow: hidden;

      .btn-icon {
        inline-size: 12px;
        block-size: 12px;
      }

      &::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(90deg, transparent, oklch(0.6 0.25 15 / 0.3), transparent);
        transform: translateX(-100%);
        transition: transform var(--duration-slow) ease;
      }

      &:hover {
        background: linear-gradient(
          135deg,
          color-mix(in oklch, oklch(0.55 0.28 15) 50%, transparent) 0%,
          color-mix(in oklch, oklch(0.45 0.3 10) 40%, transparent) 100%
        );
        color: oklch(0.85 0.2 15);
        box-shadow:
          0 0 15px oklch(0.5 0.25 15 / 0.4),
          inset 0 0 20px oklch(0.5 0.25 15 / 0.1);

        &::before {
          transform: translateX(100%);
        }
      }

      &:active {
        transform: scale(0.95);
      }
    }
  }

  
  @scope (.view-toggle) {
    :scope {
      display: flex;
      background: var(--white-10);
      border: 1px solid color-mix(in oklch, var(--accent) 30%, var(--border));
      padding: 3px;
      clip-path: polygon(5px 0, 100% 0, 100% calc(100% - 5px), calc(100% - 5px) 100%, 0 100%, 0 5px);
      gap: 2px;
    }

    .view-btn {
      padding: var(--space-xs) 10px;
      min-inline-size: 36px;
      min-block-size: 36px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-out-expo);
      display: flex;
      align-items: center;
      justify-content: center;
      clip-path: polygon(4px 0, 100% 0, 100% calc(100% - 4px), calc(100% - 4px) 100%, 0 100%, 0 4px);

      & svg {
        inline-size: var(--icon-md);
        block-size: var(--icon-md);
      }

      &:hover {
        color: var(--text-primary);
        background: var(--accent-15);
      }

      &.active {
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dim) 100%);
        color: white;
        box-shadow:
          0 0 12px var(--accent-40),
          inset 0 1px 0 var(--white-15);
      }
    }
  }

  
  .software-card.preset-recommended::after {
    content: "\2605"; 
    position: absolute;
    inset-block-start: 6px;
    inset-inline-end: 6px;
    font-size: 12px;
    color: var(--neon-cyan);
    text-shadow: var(--glow-sm) var(--neon-cyan-glow);
    z-index: 10;
    opacity: 0.7;
  }

  @keyframes filterEnter {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes activeFilterGlow {
    0%, 100% {
      opacity: 0.3;
      transform: scale(1);
    }
    50% {
      opacity: 0.5;
      transform: scale(1.02);
    }
  }

  @keyframes searchGlow {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }
}
